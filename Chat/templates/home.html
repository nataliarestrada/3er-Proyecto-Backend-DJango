{% extends "base.html" %}

{% block title %}Home{% endblock %}
{% load static %}
{% block main %}
    <!-- <div class="row">
        <form id="login">
            <input type="email" name="email">
            <input type="password" name="password" id="">
            <button>Iniciar sesión</button>
        </form>
    </div> -->
    <div class="d-flex flex-column align-items-center m-3">
        <h3 class="m-3 text-white">Log In</h3>
        <div class="card p-2">
            
            <form id="login" style="width: 400px;">
                
                <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Email</label>
                <input type="email" class="form-control" name="email" required>
                </div>
                <div class="mb-3">
                <label for="exampleInputPassword1" class="form-label">Password</label>
                <input type="password" class="form-control" name="password" required>
                </div>
                
                <button class="btn btn-warning">Iniciar sesión</button>
            </form>
            {% if error %}
                <p>{{ error }}</p>
            {% endif %}
        </div>
        
    </div>

    <script>
    
        const loginForm = document.getElementById("login")

        loginForm.onsubmit = function (event){
            event.preventDefault()

            const email = event.target.email.value
            const password = event.target.password.value

            fetch("/api/auth/login/",{
                method:"POST",
                body: JSON.stringify({
                    email,
                    password
                }),
                headers:{
                    "Content-Type":"application/json"
                }
            })
                .then(response=>response.json())
                .then(data=>{
                    console.log(data)
                    window.location.replace('http://127.0.0.1:8000/conversation')
                })
        }
    </script>
    
{% endblock %}